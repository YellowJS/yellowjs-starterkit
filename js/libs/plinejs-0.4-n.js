/*
 * PlineJS v0.4 - mobile framework
 * http://plinejs.org
 */
(function(){my={};my.Class=function(){var e=arguments.length;var d=arguments[e-1];var f=e>1?arguments[0]:null;var j=e>2;var g,c;if(d.constructor===Object){g=function(){}}else{g=d.constructor;delete d.constructor}if(f){c=function(){};c.prototype=f.prototype;g.prototype=new c();g.prototype.constructor=g;g.Super=f;b(g,f,false)}if(j){for(var h=1;h<e-1;h++){b(g.prototype,arguments[h].prototype,false)}}a(g,d);return g};var a=my.extendClass=function(c,e,d){if(e.STATIC){b(c,e.STATIC,d);delete e.STATIC}b(c.prototype,e,d)};var b=function(d,f,c){var e;if(c===false){for(e in f){if(!(e in d)){d[e]=f[e]}}}else{for(e in f){d[e]=f[e]}if(f.toString!==Object.prototype.toString){d.toString=f.toString}}}})();
/*
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(w){w.name="mustache.js";w.version="0.5.0-dev";w.tags=["{{","}}"];w.parse=n;w.compile=f;w.render=v;w.clearCache=u;w.to_html=v;var t=Object.prototype.toString;var g=Array.isArray;var c=Array.prototype.forEach;var h=String.prototype.trim;var j;if(g){j=g}else{j=function(x){return t.call(x)==="[object Array]"}}var s;if(c){s=function(y,z,x){return c.call(y,z,x)}}else{s=function(A,B,z){for(var y=0,x=A.length;y<x;++y){B.call(z,A[y],y,A)}}}var k=/^\s*$/;function d(x){return k.test(x)}var q;if(h){q=function(x){return x==null?"":h.call(x)}}else{var o,i;if(d("\xA0")){o=/^\s+/;i=/\s+$/}else{o=/^[\s\xA0]+/;i=/[\s\xA0]+$/}q=function(x){return x==null?"":String(x).replace(o,"").replace(i,"")}}var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function p(x){return String(x).replace(/&(?!\w+;)|[<>"']/g,function(y){return e[y]||y})}function l(D,F,G,z){z=z||"<template>";var H=F.split("\n"),x=Math.max(G-3,0),A=Math.min(H.length,G+3),y=H.slice(x,A);var E;for(var B=0,C=y.length;B<C;++B){E=B+x+1;y[B]=(E===G?" >> ":"    ")+y[B]}D.template=F;D.line=G;D.file=z;D.message=[z+":"+G,y.join("\n"),"",D.message].join("\n");return D}function m(x,F,A){if(x==="."){return F[F.length-1]}var E=x.split(".");var C=E.length-1;var D=E[C];var G,y,B=F.length,z,H;while(B){H=F.slice(0);y=F[--B];z=0;while(z<C){y=y[E[z++]];if(y==null){break}H.push(y)}if(y&&D in y){G=y[D];break}}if(typeof G==="function"){G=G.call(H[H.length-1])}if(G==null&&!A){return""}return G}function a(C,z,E,x,y){var B=m(z,x,true);if(y){if(B==null||B===false||(j(B)&&B.length===0)){C(E())}}else{if(j(B)){s(B,function(F){x.push(F);C(E());x.pop()})}else{if(typeof B==="object"){x.push(B);C(E());x.pop()}else{if(typeof B==="function"){var A=x[x.length-1];var D=function(F){return v(F,A)};C(B.call(A,E(),D)||"")}else{if(B){C(E())}}}}}}function n(Z,B){B=B||{};var K=B.tags||w.tags,L=K[0],G=K[K.length-1];var y=["var line = 1;","\ntry {",'\nsend("'];var F=[],aa=false,X=false;var V=function(){if(aa&&!X&&!B.space){while(F.length){y.splice(F.pop(),1)}}else{F=[]}aa=false;X=false};var S=[],P,C,M;var U=function(ab){K=q(ab).split(/\s+/);C=K[0];M=K[K.length-1]};var J=function(ab){y.push('");',P,'\nvar partial = partials["'+q(ab)+'"];',"\nif (partial) {","\n  send(render(partial, stack[stack.length - 1], partials));","\n}",'\nsend("')};var x=function(ad,ab){var ac=q(ad);if(ac===""){throw l(new Error("Section name may not be empty"),Z,I,B.file)}S.push({name:ac,inverted:ab});y.push('");',P,'\nvar name = "'+ac+'";',"\nvar callback = (function () {","\n  var buffer, send = function (chunk) { buffer.push(chunk); };","\n  return function () {","\n    buffer = [];",'\nsend("')};var E=function(ab){x(ab,true)};var T=function(ac){var ab=q(ac);var ae=S.length!=0&&S[S.length-1].name;if(!ae||ab!=ae){throw l(new Error('Section named "'+ab+'" was never opened'),Z,I,file)}var ad=S.pop();y.push('");','\n    return buffer.join("");',"\n  };","\n})();");if(ad.inverted){y.push("\nsendSection(send,name,callback,stack,true);")}else{y.push("\nsendSection(send,name,callback,stack);")}y.push('\nsend("')};var W=function(ab){y.push('");',P,'\nsend(findName("'+q(ab)+'", stack));','\nsend("')};var z=function(ab){y.push('");',P,'\nsend(escapeHTML(findName("'+q(ab)+'", stack)));','\nsend("')};var I=1,Y,D;for(var Q=0,R=Z.length;Q<R;++Q){if(Z.slice(Q,Q+L.length)===L){Q+=L.length;Y=Z.substr(Q,1);P="\nline = "+I+";";C=L;M=G;aa=true;switch(Y){case"!":Q++;D=null;break;case"=":Q++;G="="+G;D=U;break;case">":Q++;D=J;break;case"#":Q++;D=x;break;case"^":Q++;D=E;break;case"/":Q++;D=T;break;case"{":G="}"+G;case"&":Q++;X=true;D=W;break;default:X=true;D=z}var A=Z.indexOf(G,Q);if(A===-1){throw l(new Error('Tag "'+L+'" was not closed properly'),Z,I,B.file)}var O=Z.substring(Q,A);if(D){D(O)}var N=0;while(~(N=O.indexOf("\n",N))){I++;N++}Q=A+G.length-1;L=C;G=M}else{Y=Z.substr(Q,1);switch(Y){case'"':case"\\":X=true;y.push("\\"+Y);break;case"\n":F.push(y.length);y.push("\\n");V();I++;break;default:if(d(Y)){F.push(y.length)}else{X=true}y.push(Y)}}}if(S.length!=0){throw l(new Error('Section "'+S[S.length-1].name+'" was not closed properly'),Z,I,B.file)}V();y.push('");',"\nsend(null);","\n} catch (e) { throw {error: e, line: line}; }");var H=y.join("").replace(/send\(""\);\n/g,"");if(B.debug){if(typeof console!="undefined"&&console.log){console.log(H)}else{if(typeof print==="function"){print(H)}}}return H}function r(B,z){var y="view,partials,send,stack,findName,escapeHTML,sendSection,render";var x=n(B,z);var A=new Function(y,x);return function(E,F,I){if(typeof F==="function"){I=F;F={}}F=F||{};var D=[];var H=I||function(J){D.push(J)};var C=[E];try{A(E,F,H,C,m,p,a,v)}catch(G){throw l(G.error,B,G.line,z.file)}return D.join("")}}var b={};function u(){b={}}function f(y,x){x=x||{};if(x.cache!==false){if(!b[y]){b[y]=r(y,x)}return b[y]}return r(y,x)}function v(z,x,y,A){return f(z)(x,y,A)}})(Mustache);var Lawnchair=function(){if(!JSON){throw"JSON unavailable! Include http://www.json.org/json2.js to fix."}if(arguments.length<=2&&arguments.length>0){var i=typeof arguments[0]==="function"?arguments[0]:arguments[1],n=typeof arguments[0]==="function"?{}:arguments[0]}else{throw"Incorrect # of ctor args!"}if(typeof i!=="function"){throw"No callback was provided"}var l=!(this instanceof Lawnchair)?new Lawnchair(n,i):this;l.record=n.record||"record";l.name=n.name||"records";var h;if(n.adapter){h=Lawnchair.adapters[l.indexOf(Lawnchair.adapters,n.adapter)];h=h.valid()?h:undefined}else{for(var m=0,k=Lawnchair.adapters.length;m<k;m++){if(h=Lawnchair.adapters[m].valid()?Lawnchair.adapters[m]:undefined){break}}}if(!h){throw"No valid adapter."}for(var j in h){l[j]=h[j]}m=0;for(k=Lawnchair.plugins.length;m<k;m++){Lawnchair.plugins[m].call(l)}l.init(n,i);return l};Lawnchair.adapters=[];Lawnchair.adapter=function(g,j){j.adapter=g;var h="adapter valid init keys save batch get exists all remove nuke".split(" "),f=this.prototype.indexOf,i;for(i in j){if(f(h,i)===-1){throw"Invalid adapter! Nonstandard method: "+i}}Lawnchair.adapters.push(j)};Lawnchair.plugins=[];Lawnchair.plugin=function(b){for(var d in b){d==="init"?Lawnchair.plugins.push(b[d]):this.prototype[d]=b[d]}};Lawnchair.prototype={isArray:Array.isArray||function(b){return Object.prototype.toString.call(b)==="[object Array]"},indexOf:function(f,h,g,d){if(f.indexOf){return f.indexOf(h)}g=0;for(d=f.length;g<d;g++){if(f[g]===h){return g}}return -1},lambda:function(b){return this.fn(this.record,b)},fn:function(b,d){return typeof d=="string"?new Function(b,d):d},uuid:function(){var b=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b()},each:function(b){var f=this.lambda(b);if(this.__results){b=0;for(var d=this.__results.length;b<d;b++){f.call(this,this.__results[b],b)}}else{this.all(function(a){for(var e=0,c=a.length;e<c;e++){f.call(this,a[e],e)}})}return this}};Lawnchair.adapter("dom",{valid:function(){return !!window.Storage},init:function(b,f){this.storage=window.localStorage;var d=this;this.indexer={key:d.name+"._index_",all:function(){JSON.parse(d.storage.getItem(this.key))==null&&d.storage.setItem(this.key,JSON.stringify([]));return JSON.parse(d.storage.getItem(this.key))},add:function(a){var c=this.all();c.push(a);d.storage.setItem(this.key,JSON.stringify(c))},del:function(a){for(var j=this.all(),i=[],e=0,c=j.length;e<c;e++){j[e]!=a&&i.push(j[e])}d.storage.setItem(this.key,JSON.stringify(i))},find:function(a){for(var h=this.all(),e=0,c=h.length;e<c;e++){if(a===h[e]){return e}}return false}};f&&this.fn(this.name,f).call(this,this)},save:function(b,f){var d=b.key||this.uuid();this.indexer.find(d)||this.indexer.add(d);delete b.key;this.storage.setItem(d,JSON.stringify(b));if(f){b.key=d;this.lambda(f).call(this,b)}return this},batch:function(g,j){for(var h=[],f=0,i=g.length;f<i;f++){this.save(g[f],function(a){h.push(a)})}j&&this.lambda(j).call(this,h);return this},keys:function(){callback&&this.lambda(callback).call(this,this.indexer.all())},get:function(h,l){if(this.isArray(h)){for(var j=[],g=0,k=h.length;g<k;g++){var i=JSON.parse(this.storage.getItem(h[g]));if(i){i.key=h[g];j.push(i)}}l&&this.lambda(l).call(this,j)}else{if(i=JSON.parse(this.storage.getItem(h))){i.key=h}l&&this.lambda(l).call(this,i)}return this},all:function(h){for(var l=this.indexer.all(),j=[],g,k=0,i=l.length;k<i;k++){g=JSON.parse(this.storage.getItem(l[k]));g.key=l[k];j.push(g)}h&&this.fn(this.name,h).call(this,j);return this},remove:function(b,f){var d=typeof b==="string"?b:b.key;this.indexer.del(d);this.storage.removeItem(d);f&&this.lambda(f).call(this);return this},nuke:function(b){this.all(function(f){for(var d=0,a=f.length;d<a;d++){this.remove(f[d])}b&&this.lambda(b).call(this)});return this}});Lawnchair.adapter("window-name",function(b,f){var d=window.top.name?JSON.parse(window.top.name):{};return{valid:function(){return typeof window.top.name!="undefined"},init:function(a,c){d[this.name]={index:[],store:{}};b=d[this.name].index;f=d[this.name].store;this.fn(this.name,c).call(this,this)},keys:function(a){this.fn("keys",a).call(this,b);return this},save:function(a,e){var c=a.key||this.uuid();a.key&&delete a.key;this.exists(c,function(h){h||b.push(c);f[c]=a;window.top.name=JSON.stringify(d);if(e){a.key=c;this.lambda(e).call(this,a)}});return this},batch:function(a,j){for(var i=[],e=0,c=a.length;e<c;e++){this.save(a[e],function(g){i.push(g)})}j&&this.lambda(j).call(this,i);return this},get:function(a,j){var i;if(this.isArray(a)){i=[];for(var e=0,c=a.length;e<c;e++){i.push(f[a[e]])}}else{if(i=f[a]){i.key=a}}j&&this.lambda(j).call(this,i);return this},exists:function(a,c){this.lambda(c).call(this,!!f[a]);return this},all:function(a){for(var j=[],i=0,e=b.length;i<e;i++){var c=f[b[i]];c.key=b[i];j.push(c)}this.fn(this.name,a).call(this,j);return this},remove:function(a,j){for(var i=this.isArray(a)?a:[a],e=0,c=i.length;e<c;e++){delete f[i[e]];b.splice(this.indexOf(b,i[e]),1)}window.top.name=JSON.stringify(d);j&&this.lambda(j).call(this);return this},nuke:function(a){storage={};b=[];window.top.name=JSON.stringify(d);a&&this.lambda(a).call(this);return this}}}());var pline,oo;oo=pline=(function(d){var l={templateEngine:"mustache",viewportSelector:"body",pushState:false};return{Class:function n(){return my.Class.apply(this,arguments)},log:function c(u){if(d.console&&d.console.log){var v=("string"!==typeof u&&"toString" in u)?u.toString():u;console.log(u.toStirng())}},warn:function r(u){var v=("string"!==typeof u&&"toString" in u)?u.toString():u;if(d.console&&d.console.warn){console.warn(v)}else{oo.log("/!\\ Warning : "+v)}},getNS:function g(x,y){var z=x.split(".");var w=d;for(var v=0,u=z.length;v<u;v++){if("object"!=typeof(w[z[v]])){w[z[v]]={}}w=w[z[v]]}return w},createDelegate:function e(v,u){return function(){return v.apply(u,arguments)}},emptyFn:function j(){},generateId:function p(v){var u=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return["id-",u()+u()+"-"+u()+"-"+u()+"-"+u()+"-"+u()+u()+u()].join("")},override:function f(v,u){for(var w in u){v[w]=u[w]}return v},createController:function i(v){if(!v&&("object"!==typeof v)){throw new Error("Wrong parameter")}var u=v.constructor=function(){u.Super.call(this)};var w=my.Class(oo.router.Controller,v);return w},getRouter:function t(){return oo.router.router||(oo.router.router=new oo.router.Router())},initViewport:function m(u){var v=this.getNS("oo.view");v.viewport=new v.Viewport(u);return v.viewport},getViewport:function o(){var u=this.getNS("oo.view");if(u.viewport){return u.viewport}else{return this.initViewport()}},createPanel:function s(v){if(!(typeof v=="object"&&"id" in v)){throw"Wrong parameter"}var x=v.id;delete v.id;var u=v.constructor=function(){u.Super.call(this)};var w=oo.Class(oo.view.Panel,v);oo.getViewport().register(x,w);return w},createModel:function h(u){return new oo.data.Model(u)},createElement:function k(v,u){return new (oo.view.Element.get(v))(u||null)},define:function b(u){this.override(l,u)},getConfig:function q(u){if(u&&u in l){return l[u]}else{return l}},bootstrap:function a(u){if(typeof u!=="function"){throw"parameter must be a function"}var w=this;function v(){d.scroll(0,0);document.addEventListener("touchmove",function(x){x.preventDefault()},false);u.call(d,w)}if("PhoneGap" in d&&PhoneGap.available){document.addEventListener("deviceready",v)}else{d.addEventListener("load",v)}}}})(window);(function(g){var c=this;function d(k){var j;if(typeof k=="object"&&k.sc&&k.fn){j={fn:k.fn,sc:k.sc}}else{j={fn:k,sc:c}}return j}var i=my.Class({_getListenersArray:function b(){if(!this._listeners){this._listeners={}}return this._listeners},addListener:function a(k,n){var j=this._getListenersArray();if(!j[k]){j[k]=[]}var m=d(n);j[k].push(m)},removeListener:function f(k,o){var j=this._getListenersArray();if(j[k]){var n=d(o);var m=j[k].indexOf(n);if(-1!=m){j[k].splice(m,1)}}},triggerEvent:function h(m,p){if((typeof p!="array")&&3==arguments.length){p=arguments[2]}var k=this._getListenersArray();if(k[m]){for(var n=0,j=k[m].length;n<j;n++){var o=k[m][n];o.fn.apply(o.sc,p)}}}});var e=g.getNS("oo.core.mixins");e.Events=i})(oo||{});(function(a){var h="ontouchstart" in window?true:false;var g=function g(j,i){var k=null;if(e.HAS_TOUCH){i=i||0;k=j.touches[i];if(undefined===k){k=j.changedTouches[i]}}else{k=j}return[parseInt(k.pageX,10),parseInt(k.pageY,10)]};var e=my.Class({STATIC:{getPosition:g,getPositionX:function d(j,i){return g(j,i)[0]},getPositionY:function c(j,i){return g(j,i)[1]},getTarget:function f(j,i){return j.touches[i||0].target},HAS_TOUCH:"ontouchstart" in window?true:false}});if(!e.HAS_TOUCH){e.EVENT_START="mousedown";e.EVENT_MOVE="mousemove";e.EVENT_END="mouseup"}else{e.EVENT_START="touchstart";e.EVENT_MOVE="touchmove";e.EVENT_END="touchend"}var b=a.getNS("oo.core");b.Touch=e})(oo||{});(function(h){var c=h.getNS("oo.router").Router=h.Class({constructor:function f(){this._routes={};this._registeredControllers={};this._controllers={};var o=this},_usePushState:function l(){return h.getConfig("pushState")},addRoutes:function d(o){if(!o||(Object.prototype.toString.call(o)!=="[object Object]")){throw new Error("Routes must exist and must be an object literal")}for(var p in o){this.addRoute(p,o[p])}},addRoute:function b(o,p){if(!o||!p.hasOwnProperty("url")||!p.hasOwnProperty("controller")||!p.hasOwnProperty("action")){throw new Error('A route must have a name and properties "url", "controller" and "action"')}if(!this.isValidUrl(p.url)){throw new Error('The url property must begun by "/"')}var q={};q[o]=p;this._routes=h.override(this._routes,q);delete q[o]},isValidUrl:function n(o){return("/"===o.slice(0,1))},addController:function j(p,o){if(!p||("string"!==typeof p)){throw new Error('Wrong "name" parameter : Must exist and be a string')}if("function"!==typeof o){throw new Error('Wrong "cls" parameter : Must be a function')}var q={};q[p]=o;this._controllers=h.override(this._controllers,q)},addControllers:function e(o){if(!o||(Object.prototype.toString.call(o)!=="[object Object]")){throw new Error("Wrong parameter : must exist and be an object")}for(var p in o){this.addController(p,o[p])}},init:function m(){var o=this,q=window.location,p=false;var r=function r(s){o.dispatch(s)};if(this._usePushState()&&window.history&&window.history.pushState){this.hasHistory=true;window.addEventListener("popstate",function(s){p=true;r(q.pathname)});window.setTimeout(function(){if(!p){o.dispatch(q.pathname)}},1)}else{window.addEventListener("hashchange",function(s){r(q.hash.slice(1))},false);r(q.hash.slice(1))}},load:function k(o){if(!this._usePushState()||!this.hasHistory){window.location.hash=o}else{history.pushState({},"",o);this.dispatch(o)}},dispatch:function i(r){this.parseRoute(r);if(this.requestParams){var q=[this.requestParams.controller.charAt(0).toUpperCase(),this.requestParams.controller.substring(1),"Controller"].join("");var o=[this.requestParams.action,"Action"].join("");var p;if((typeof this._registeredControllers[q]!=="function")&&("undefined"!==typeof this._controllers[q])){if("undefined"===typeof this._registeredControllers[q]){this._registeredControllers[q]=new this._controllers[q]()}p=this._registeredControllers[q];if(typeof p[o]==="function"){p[o](this.requestParams.params)}}}},parseRoute:function g(p){var o=this._routes;var q=null;for(var t in o){var s=o[t];if(s.url==p.substring(0,s.url.length)){q={controller:s.controller,action:s.action};p=p.substring(s.url.length)}}if("/"==p.substring(0,1)){p=p.slice(1)}var u=p.split("/");if(!q){q={controller:u[0],action:u[1]};if(!q.controller){q.controller="index"}else{u.shift()}if(!q.action||q.action===undefined){q.action="index"}else{u.shift()}}q.params={};while(u.length){paramName=u.shift();if(paramName){paramValue=u.shift();if(paramValue!==undefined){q.params[paramName]=paramValue}}}this.requestParams=q;return q},url:function a(o,s){var p=this._routes[o];if(!p){throw Error("route name doesn't exists")}var q="";for(var r in s){q=[q,"/",r,"/",s[r]].join("")}return[p.url,q].join("")}})})(oo||{});(function(a){var d=a.getNS("oo.router").Controller=a.Class({_controllers:{},_viewport:null,constructor:function b(){this._viewport=a.getViewport()},getViewport:function c(){return a.getViewport()}})})(oo||{});var oo=(function(a){var e=this;var f=a.getNS("oo.data");var d={};f.Provider=a.Class({STATIC:{register:function c(g,h){if(d[h]){throw"Already existing codename"}d[h]=g},get:function b(g){if(g in d){return d[g]}else{throw"Invalid codename for a provider"}},unregister:function c(g){delete d[g]}},_name:"",_data:{},constructor:function(g){if(g&&"name" in g&&typeof g.name=="string"){this._name=g.name}else{throw"Config object must contain a name property"}},save:function(g){throw"Can't be called directly from Provider class"},fetch:function(g){throw"Can't be called directly from Provider class"},get:function(g){throw"Can't be called directly from Provider class"},clearAll:function(g){throw"Can't be called directly from Provider class"}});return a})(oo||{});(function(a){var f=this,d=a.getNS("oo.data");var b=d.FakeProvider=a.Class(a.data.Provider,{_data:[{key:0,firstname:"claire",nickname:"Claire_So",title:"article 1",picture:"1.jpg",elementCls:"elementA",url:"article/1"},{key:1,firstname:"mathias",nickname:"FreakDev",title:"article 2",picture:"2.jpg",elementCls:"elementA",url:"article/2"},{key:2,firstname:"ff",nickname:"FreakDev",title:"article 3",picture:"3.jpg",elementCls:"elementA",url:"article/3"},{key:3,firstname:"gg",nickname:"FreakDev",title:"article 4",picture:"4.jpg",elementCls:"elementA",url:"article/4"},{key:4,firstname:"gg",nickname:"FreakDev",title:"article 5",picture:"3.jpg",elementCls:"elementA",url:"article/5"},{key:5,firstname:"gg",nickname:"FreakDev",title:"article 6",picture:"1.jpg",elementCls:"elementA",url:"article/6"},{key:6,firstname:"gg",nickname:"FreakDev",title:"article 7",picture:"3.jpg",elementCls:"elementA",url:"article/7"},{key:7,firstname:"gg",nickname:"FreakDev",title:"article 8",picture:"4.jpg",elementCls:"elementA",url:"article/8"},{key:8,firstname:"gg",nickname:"FreakDev",title:"article 9",picture:"1.jpg",elementCls:"elementA",url:"article/9"},{key:9,firstname:"gg",nickname:"FreakDev",title:"article 10",picture:"2.jpg",elementCls:"elementA",url:"article/10"}],constructor:function g(h){b.Super.call(this,h)},save:function e(i,j){if(!(i instanceof Array)){i=[i]}var h=this;i.forEach(function(k){h._data.push(k)});if(j){j.call(f)}},fetch:function c(h){if(h&&"success" in h){h.success.call(f,this._data)}}});a.data.Provider.register(b,"fake")})(oo||{});(function(g){var b=this,i=g.getNS("oo.data");var c=i.LocalProvider=g.Class(g.data.Provider,{_store:{},constructor:function f(j){c.Super.call(this,j);this._store=Lawnchair({name:this._name,record:"record"},function(){})},save:function h(j,k){if(!(j instanceof Array)){j=[j]}this._store.batch(j);k.call(b)},fetch:function a(j){this._store.all(function(k){j.call(b,k)})},get:function d(j,k){this._store.get(j,k)},clearAll:function e(){this._store.nuke()}});g.data.Provider.register(c,"local")})(oo||{});(function(h){var b=this,l=h.getNS("oo.data");var m=l.AjaxProvider=h.Class(h.data.Provider,{_store:{},_cacheProvider:null,_clearCache:true,_url:null,constructor:function d(n){var p={cacheProvider:"local"};var o=h.override(p,n);if(!o.url||typeof o.url!="string"){throw"'url' property must be set"}this._url=o.url;m.Super.call(this,{name:o.name});this._cacheProvider=new (h.data.Provider.get(o.cacheProvider||"local"))({name:"pline-cache__"+o.name})},save:function j(q,o){var s="POST";var r={success:h.emptyFn,error:h.emptyFn};if(typeof o=="function"){o={success:o}}var n=h.override(r,o);var p=this._buildReq(this._url,s,q,function(t){this._cacheProvider.save(q,function(){n.success.call(b,t)})},n.error);p.send()},fetch:function a(o){var r="GET";var q={success:h.emptyFn,error:h.emptyFn,params:{}};if(typeof o=="function"){o={success:o}}var n=h.override(q,o);var p=this._buildReq(this._url,r,n.params,function(s){var t=this;this._cacheProvider.clearAll();this._cacheProvider.save(s,function(){t._clearCache=false;n.success.call(b,s)})},n.error);p.send()},get:function c(n,p){var o=this;if(this._clearCache){this.fetch(function(q){o._cacheProvider.get(n,p)})}else{this._cacheProvider.get(n,p)}},clearAll:function g(){this._clearCache=true},_buildReq:function f(o,n,t,p,u){var w=this._getRequest(),v=this;w.addEventListener("readystatechange",function(x){if(x.target.readyState==4){if(x.target.status==200){var y=JSON.parse(x.target.responseText);p.call(v,y)}else{u.call(v)}}});var r=this._processParams(t),q=""+o;if(n=="GET"){q=o+"?"+r}w.open(n,q);if("POST"==n){this._setPostHeaders(w)}return{send:function s(x){if("POST"===n){w.send(r)}else{w.send()}}}},_processParams:function i(n){var o=[];for(var p in n){o.push(p+"="+encodeURI(n[p]))}return o.join("&")},_getRequest:function e(){return new XMLHttpRequest()},_setPostHeaders:function k(n){n.setRequestHeader("X-Requested-With","XMLHttpRequest");n.setRequestHeader("Content-type","application/x-www-form-urlencoded")}});h.data.Provider.register(m,"ajax")})(oo||{});(function(h){var g=h.data.Provider;var c=h.getNS("oo.data").Model=h.Class(null,h.core.mixins.Events,{STATIC:{AFTER_SAVE:"AFTER_SAVE",AFTER_FETCH:"AFTER_FETCH"},_data:null,_indexes:null,_previouslyFetched:{},constructor:function d(j){if(!j||(!j.hasOwnProperty("name")||!j.hasOwnProperty("provider"))){throw'Either property "name" or "provider" is missing in the options given to the Model constructor'}this._name=j.name;if(j.hasOwnProperty("indexes")){this.setIndexes(j.indexes)}this.setProvider(j.provider)},setProvider:function b(j){if(j instanceof g){this._provider=j}else{if(typeof j=="object"){var k=h.data.Provider.get(j.type);delete j.type;j.name=this._name;this._provider=new k(j)}}},setIndexes:function e(k){for(var l=0,j=k.length;l<j;l++){this._indexes=k[l]}},fetch:function a(m){var l={success:h.emptyFn,params:{}};m=m||{};if(typeof m=="function"){m={success:m}}if(typeof m!="object"){throw"Model.fetch() : params must be a function or a config object"}m=h.override(l,m);var k=this,j=function j(n){if(n){this._previouslyFetched=n;if(m.success){m.success(n)}k.triggerEvent(c.AFTER_FETCH,[n])}};this._provider.fetch({success:j,params:m.params})},getData:function f(){return this._previouslyFetched},save:function i(j,k){if(!j||("object"!==typeof j)){throw Error("Data parameter must exist and be an object")}this._provider.save(j,k);this.triggerEvent(c.AFTER_SAVE)}})})(oo||{});var oo=(function(b){var f=this;var g=b.getNS("oo.view.templateengine");var a={};var e=g.Template=my.Class({STATIC:{register:function d(h,i){if(a[i]){throw"Already existing codename"}a[i]=h},get:function c(h){if(h in a){return a[h]}else{throw"Invalid codename"}},unregister:function d(h){delete a[h]}},constructor:function(h){},render:function(i,h){throw"Can't be called directly from Template class"}});return b})(oo||{});var oo=(function(a){var c=this;var d=a.getNS("oo.view.templateengine");var b=d.TemplateEngineMustache=my.Class(a.view.templateengine.Template,{constructor:function(e){b.Super.call(this,e)},render:function(f,e){if(!e&&!f){throw new Error("datas, tpl and domElem must exist")}return Mustache.render(f,e)}});d.Template.register(b,"mustache");return a})(oo||{});var oo=(function(a){var b=this;var d=a.getNS("oo.view.templateengine");var c=d.TemplateEngineHandlebars=my.Class(a.view.templateengine.Template,{constructor:function(e){c.Super.call(this,e)},render:function(f,e){if(!e&&!f){throw new Error("datas, tpl and domElem must exist")}var g=Handlebars.compile(f);return g(e)}});d.Template.register(c,"handlebars");return a})(oo||{});(function(oo){var ClassList=oo.Class({constructor:function constructor(obj){this._dom=obj;this._list=obj.className.split(" ")},destroy:function destroy(){this._dom=null;this._list.splice(0);this._list=null},_updateClassList:function _updateClassList(){this._dom.className=this._list.join(" ")},removeClass:function removeClass(clsName){if(typeof clsName=="string"){clsName=clsName.split(" ")}var updated=false;var that=this;clsName.forEach(function(element,index,array){var i=that._list.indexOf(element);if(-1!==i){that._list.splice(i,1);updated=true}});if(updated){this._updateClassList()}},addClass:function addClass(clsName){if(typeof clsName=="string"){clsName=clsName.split(" ")}if(!this.hasClass(clsName)){clsName.splice(0,0,0,0);Array.prototype.splice.apply(this._list,clsName);this._updateClassList()}},setClass:function setClass(clsName){if(typeof clsName=="string"){clsName=clsName.split(" ")}this._list=clsName;this._updateClassList()},hasClass:function hasClass(clsName){var i=this._list.indexOf(clsName);if(-1===i){return false}else{return true}},getClasses:function getClasses(){return this._list}});var prop={readOnly:[],readWrite:["width","height","zIndex","display","top","right","bottom","left","webkitTransitionProperty","webkitTransitionTimingFunction","webkitTransitionDuration"]};var Dom=oo.getNS("oo.view").Dom=oo.Class(oo.emptyFn,oo.core.mixins.Events,{STATIC:{CSSMATRIXPATTERN:/matrix\(1, 0, 0, 1, (-?[0-9.]+), (-?[0-9.]+)\)/,createElement:function createElement(tag){return new Dom(document.createElement(tag))}},constructor:function constructor(identifier){this._dom=null;this._cached={};this._template=null;this._cacheTpl=null;if(typeof identifier=="string"){this._identifier=identifier}else{if(identifier instanceof Object){this.setDomObject(identifier)}else{throw"Fatal Error : No identifier !"}}this.generateAccessor()},destroy:function destroy(){this.classList.destroy();this.classList=null;this._cached.splice(0);this._cached=null;this._dom.removeEventListeners();document.removeElement(this._dom);this._dom=null},generateAccessor:function generateAccessor(){var p=this,i,len;for(i=0,len=prop.readOnly.length;i<len;i++){eval(["p.get",prop.readOnly[i].charAt(0).toUpperCase(),prop.readOnly[i].slice(1)," = function (unit, noCache) { if (noCache || !this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')]) { this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')] = (unit ? window.getComputedStyle(this.getDomObject()).",prop.readOnly[i]," : (window.getComputedStyle(this.getDomObject()).",prop.readOnly[i],").replace(/s|ms|px|em|pt|%/, '')); this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')] = parseInt(this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')], 10) || this._cached[['",prop.readOnly[i],"',(unit ? 'u' : '')].join('')]; } return this._cached[['",prop.readOnly[i],"', (unit ? 'u' : '')].join('')]; };"].join(""))}for(i=0,len=prop.readWrite.length;i<len;i++){eval(["p.get",prop.readWrite[i].charAt(0).toUpperCase(),prop.readWrite[i].slice(1)," = function (unit, noCache) { if (noCache || !this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')]) { this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')] = (unit ? window.getComputedStyle(this.getDomObject()).",prop.readWrite[i]," : (window.getComputedStyle(this.getDomObject()).",prop.readWrite[i],").replace(/s|ms|px|em|pt|%/, '')); this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')] = parseInt(this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')], 10) || this._cached[['",prop.readWrite[i],"',(unit ? 'u' : '')].join('')]; } return this._cached[['",prop.readWrite[i],"', (unit ? 'u' : '')].join('')]; };"].join(""));eval(["p.set",prop.readWrite[i].charAt(0).toUpperCase(),prop.readWrite[i].slice(1)," = function (val, unit) { if (this._cached['",prop.readWrite[i],"'] || this._cached[['",prop.readWrite[i],"', 'u'].join('')]) { this._cached['",prop.readWrite[i],"'] = this._cached[['",prop.readWrite[i],"', 'u'].join('')] = null; } this.getDomObject().style.",prop.readWrite[i]," = [val, (undefined !== unit ? unit : '')].join(''); return this };"].join(""))}},getTranslations:function getTranslations(noCache){if(!this._cached.webkitTranslations||noCache){var values=this.getWebkitTransform().match(Dom.CSSMATRIXPATTERN);if(null===values){values=[0,0,0]}this._cached.webkitTranslations=[parseInt(values[1],10),parseInt(values[2],10)]}return this._cached.webkitTranslations},getWebkitTransform:function getWebkitTransform(noCache){if(!this._cached.webkitTransform||noCache){this._cached.webkitTransform=window.getComputedStyle(this.getDomObject()).webkitTransform}return this._cached.webkitTransform},setWebkitTransform:function setWebkitTransform(value){if(this._cached.webkitTransform||this._cached.webkitTranslations){this._cached.webkitTransform=null;this._cached.webkitTranslations=null}this.getDomObject().style.webkitTransform=value;return this},setTranslations:function setTranslations(x,y,unit){unit=unit||"px";this.setWebkitTransform(["translate3d(",x,unit,", ",y,unit,", 0)"].join(""));return this},getTranslateX:function getTranslateX(unit,noCache){return(unit?[this.getTranslations(noCache)[0],"px"].join(""):this.getTranslations(noCache)[0])},getTranslateY:function getTranslateY(unit,noCache){return(unit?[this.getTranslations(noCache)[1],"px"].join(""):this.getTranslations(noCache)[1])},setTranslateX:function setTranslateX(val){var valY=this.getTranslateY();this.setTranslations(val,valY);return this},setTranslateY:function setTranslateY(val){var valX=this.getTranslateX();this.setTranslations(valX,val);return this},setDomObject:function setDomObject(domNode){if(typeof domNode=="string"){var n=document.querySelector(domNode);if(null===n){throw"Invalid selector node doesn't exists"}domNode=n}this._dom=domNode;if(domNode&&(!("id" in domNode)||domNode.id==="")){this._dom.id=oo.generateId(this._dom.tagName)}this.classList=new ClassList(this.getDomObject());return this},getDomObject:function getDomObject(){if(!this._dom){this.setDomObject(this._identifier)}return this._dom},find:function find(selector){var n=this.getDomObject().querySelector(selector);if(null===n){return null}else{return new Dom(n)}},findParentByCls:function findParentByCls(cls){var p=this.getDomObject().parentNode;var pattern=new RegExp(cls);while(!pattern.test(p.className)&&p&&(Node.DOCUMENT_NODE!==p.nodeType)){p=p.parentNode}if(p&&(Node.DOCUMENT_NODE!==p.nodeType)){return new Dom(p)}else{return false}},appendDomNode:function appendDomNode(domNode){this.getDomObject().appendChild(domNode);return this},prependDomNode:function prependDomNode(domNode){this.getDomObject().insertBefore(domNode,this.getDomObject().firstChild);return this},appendChild:function appendChild(node){if(node instanceof Dom){this.appendDomNode(node.getDomObject())}else{this.appendDomNode(node)}return this},prependChild:function prependChild(node){if(node instanceof Dom){this.prependDomNode(node.getDomObject())}else{this.prependDomNode(node)}return this},appendHtml:function appendHtml(html){this.getDomObject().innerHTML+=html;return this},removeChild:function removeChild(node){this.getDomObject().removeChild(node)},clear:function clear(){this.getDomObject().innerHTML="";return this},stopAnimation:function stopAnimation(){this.setWebkitTransitionDuration(0,"ms");this.getDomObject().removeEventListener("webkitTransitionEnd");return this},translateTo:function translateTo(coord,duration,listener,timingFunction){if(typeof coord==="object"){coord.x="undefined"!==typeof coord.x?coord.x:this.getTranslateX();coord.y="undefined"!==typeof coord.y?coord.y:this.getTranslateY()}var currentTransitionDuration=(this.getWebkitTransitionDuration()*1000);duration=duration||0;this.setWebkitTransitionDuration(duration,"ms");var currentTimingFunction=this.getWebkitTransitionTimingFunction();if(typeof timingFunction==="string"){this.setWebkitTransitionTimingFunction(timingFunction,"")}var that=this,endListener=function endListener(e){that.getDomObject().removeEventListener("webkitTransitionEnd",endListener);that.setWebkitTransitionDuration(currentTransitionDuration,"ms");that.setWebkitTransitionTimingFunction(currentTimingFunction,"");if(listener){listener.call(that,e)}};this.getDomObject().addEventListener("webkitTransitionEnd",endListener,false);this.setTranslations(coord.x,coord.y);return this},setId:function setId(id){this.getDomObject().id=id},getId:function getId(id){return this.getDomObject().id},setTemplate:function setTemplate(tpl){this._template=tpl;return this},render:function render(data,tpl,resetCache){if(tpl){this.setTemplate(tpl)}if(!this._cacheTpl||resetCache){data=data||{};this._cacheTpl=Mustache.to_html(this._template,data)}this.appendHtml(this._cacheTpl);return this}})})(oo);(function(h){var g=h.view.Dom,d=h.core.Touch;var a=h.getNS("oo.view").Scroll=h.Class({STATIC:{VERTICAL:"v",HORIZONTAL:"h",BOTH:"b",NONE:"none"},constructor:function e(o,n,p){this._wrapper=new g(o);this._content=this._wrapper.find(".content");this._orientation=n||a.VERTICAL;this._displayScroll=p||a.BOTH;this._vscrollbarWrapper=null;this._vscrollbar=null;this._hscrollbarWrapper=null;this._hscrollbar=null;this._maxvScrollTranslate=null;this._maxhScrollTranslate=null;this._buildScrollbars();this.initSizes();this._startY=0;this._startX=0;this._touchStartY=null;this._touchInterY=null;this._touchStartX=null;this._touchInterX=null;this._startTime=null;this._render()},initSizes:function m(){this._content.getWidth(false,true);this._content.getHeight(false,true);this._content.translateTo({x:0,y:0},0);this._startY=0;this._startX=0;if(a.VERTICAL==this._orientation||a.BOTH==this._orientation){this._vscrollbar.setDisplay("");this._maxvTranslate=(this._wrapper.getHeight()-this._content.getHeight());if(this._maxvTranslate>0){this._maxvTranslate=0;this._vscrollbar.setDisplay("none")}this._determineScrollbarSize(a.VERTICAL);this._vscrollbar.translateTo({y:0},0)}if(a.HORIZONTAL==this._orientation||a.BOTH==this._orientation){this._hscrollbar.setDisplay("");this._maxhTranslate=(this._content.getWidth()-this._wrapper.getWidth());if(this._maxhTranslate<0){this._maxhTranslate=0;this._hscrollbar.setDisplay("none")}this._determineScrollbarSize(a.HORIZONTAL);this._hscrollbar.translateTo({x:0},0)}},_buildScrollbars:function c(){if(a.VERTICAL==this._orientation||a.BOTH==this._orientation){this._vscrollbarWrapper=g.createElement("div");this._vscrollbar=g.createElement("div");this._vscrollbar.classList.addClass("oo-scrollbar");this._vscrollbar.setWidth(100,"%");this._vscrollbarWrapper.classList.addClass("oo-scroll-wrapper");this._vscrollbarWrapper.classList.addClass("oo-vscroll-wrapper");this._vscrollbarWrapper.appendChild(this._vscrollbar)}if(a.HORIZONTAL==this._orientation||a.BOTH==this._orientation){this._hscrollbarWrapper=g.createElement("div");this._hscrollbar=g.createElement("div");this._hscrollbar.classList.addClass("oo-scrollbar");this._hscrollbar.setHeight(100,"%");this._hscrollbarWrapper.classList.addClass("oo-scroll-wrapper");this._hscrollbarWrapper.classList.addClass("oo-hscroll-wrapper");this._hscrollbarWrapper.appendChild(this._hscrollbar)}},_renderScrollbars:function k(){if((this._displayScroll==a.VERTICAL||this._displayScroll==a.BOTH)&&(a.VERTICAL==this._orientation||a.BOTH==this._orientation)){this._wrapper.appendChild(this._vscrollbarWrapper)}if((this._displayScroll==a.HORIZONTAL||this._displayScroll==a.BOTH)&&(a.HORIZONTAL==this._orientation||a.BOTH==this._orientation)){this._wrapper.appendChild(this._hscrollbarWrapper)}},_determineScrollbarSize:function b(n){var p=(a.VERTICAL==n?"Height":"Width");var o=this._content[["get",p].join("")]()/this._wrapper[["get",p].join("")]();var q=parseInt(this._wrapper[["get",p].join("")]()/o,10);this[["_",n,"scrollbar"].join("")][["set",p].join("")](q);this[["_max",n,"ScrollTranslate"].join("")]=this._wrapper[["get",p].join("")]()-q},_determineScrollbarTranslate:function j(o,n){var p=this[["_max",n,"Translate"].join("")]/o;return(this[["_max",n,"ScrollTranslate"].join("")]/p)*(a.HORIZONTAL==n?-1:1)},_initListeners:function f(){var o=this._content.getDomObject();var n=this;var p;o.addEventListener(d.EVENT_START,function(q){p=0;if(a.VERTICAL==this._orientation||a.BOTH==this._orientation){n._vscrollbar.stopAnimation()}if(a.HORIZONTAL==this._orientation||a.BOTH==this._orientation){n._hscrollbar.stopAnimation()}n._content.stopAnimation();n._touchStartY=n._touchInterY=d.getPositionY(q);n._touchStartX=n._touchInterX=d.getPositionX(q);n._startTime=(new Date()).getTime();n._startY=n._content.getTranslateY(false,true);n._startX=n._content.getTranslateX(false,true)},false);o.addEventListener(d.EVENT_MOVE,function(s){var r,q;if(a.VERTICAL==n._orientation||a.BOTH==n._orientation){r=d.getPositionY(s)-n._touchStartY;q=n._startY+r;n._content.setTranslateY(q);n._vscrollbar.setTranslateY(n._determineScrollbarTranslate(q,a.VERTICAL))}if(a.HORIZONTAL==n._orientation||a.BOTH==n._orientation){r=d.getPositionX(s)-n._touchStartX;q=n._startX+r;n._content.setTranslateX(q);n._hscrollbar.setTranslateX(n._determineScrollbarTranslate(q,a.HORIZONTAL))}p++;s.preventDefault()},false);o.addEventListener(d.EVENT_END,function(u){var r=(new Date()).getTime();var t=r-n._startTime;var q=0.0006;var s=500;function v(w){var y=n._content[["getTranslate",(a.VERTICAL==w?"Y":"X")].join("")](false,true);var C=null;var x=d[["getPosition",(a.VERTICAL==w?"Y":"X")].join("")](u);var B=x-n[["_touchInter",(a.VERTICAL==w?"Y":"X")].join("")];var A=Math.abs(B)/t;var z=((A*A)/(2*q))*(B<0?-1:1);if((a.VERTICAL==w&&y>0)||(a.HORIZONTAL==w&&y>0)){C=0}else{if((a.VERTICAL==w&&y<n[["_max",w,"Translate"].join("")])||(a.HORIZONTAL==w&&Math.abs(y)>n[["_max",w,"Translate"].join("")])){C=n[["_max",w,"Translate"].join("")]*(a.HORIZONTAL==w?-1:1)}else{C=n._content[["getTranslate",(a.VERTICAL==w?"Y":"X")].join("")](false,true)+z;C=parseInt((C>0?0:(C<n[["_max",w,"Translate"].join("")]?n[["_max",w,"Translate"].join("")]:C)),10)*(a.HORIZONTAL==w?-1:1);s=A/q}}if(C!==null){var D={};D[(a.VERTICAL==w?"y":"x")]=C;n._content.translateTo(D,s,function(){n._content.stopAnimation()},"ease-out");D[(a.VERTICAL==w?"y":"x")]=n._determineScrollbarTranslate(C,w);n[["_",w,"scrollbar"].join("")].translateTo(D,s,function(){n[["_",w,"scrollbar"].join("")].stopAnimation()},"ease-out");n[["_start",(a.VERTICAL==w?"Y":"X")].join("")]=C}}if(a.VERTICAL==n._orientation||a.BOTH==n._orientation){v(a.VERTICAL)}if(a.HORIZONTAL==n._orientation||a.BOTH==n._orientation){v(a.HORIZONTAL)}},false)},_render:function i(){this._wrapper.classList.addClass("oo-list-wrapper");this._initListeners();this._renderScrollbars()},destroy:function l(){this._wrapper.destroy();this._content.getDomObject().removeEventListener(d.EVENT_START);this._content.getDomObject().removeEventListener(d.EVENT_MOVE);this._content.getDomObject().removeEventListener(d.EVENT_END);this._content.destroy();this._vscrollbarWrapper.destroy();this._vscrollbar.destroy();this._hscrollbarWrapper.destroy();this._hscrollbar.destroy()}})})(oo||{});(function(l){var c=this,k={};var d=l.getNS("oo.view").Element=l.Class(l.view.Dom,{STATIC:{register:function n(o,p){if(k[p]){throw"Already existing codename"}k[p]=o},get:function f(o){if(o in k){return k[o]}else{throw"Invalid codename"}},unregister:function n(o){delete k[o]},getTemplateEngine:function i(){if(null===d.templateEngine){d.templateEngine=new (l.view.templateengine.Template.get(l.getConfig("templateEngine")))()}return d.templateEngine},templateEngine:null},_needToRender:true,needToRender:function a(){return this._needToRender},_tpl:null,constructor:function h(o){if(!o||typeof o!="object"){throw'call Element constructor but "options" missing'}if(!o.hasOwnProperty("target")&&!o.hasOwnProperty("el")){throw'call Element constructor but "el" property of object options is missing'}d.Super.call(this,o.el||o.target);if(o.hasOwnProperty("template")){this.setTemplate(o.template);delete o.template}},setTemplate:function e(o){this._tpl=o||""},render:function b(p,o){if(!o||""===o){o=this._tpl}if(!o){return""}var q=d.getTemplateEngine();return q.render(o,p||{})},renderTo:function m(r,q,o){var p=this.render(q,o);if(typeof p==="string"){r.appendHtml(p)}else{r.appendChild(p)}},createElement:function g(p,o){if(o.el){o.el="#"+this.getId()+" "+o.el}return l.createElement(p,o)},setScrollable:function j(p){var o=new l.view.Scroll(this.getDomObject(),p,p)}});l.view.Element.register(d,"node")})(oo);(function(b){var h=this;var a=b.getNS("oo.view").ModelElement=b.Class(b.view.Element,{_model:null,constructor:function f(i){if(i.hasOwnProperty("model")){this.setModel(i.model);delete i.model}a.Super.call(this,i)},afterFetch:function g(j){var i=this.render(j,this._tpl);this.appendHtml(i)},setModel:function e(i){if(i instanceof b.data.Model){this._model=i}else{this._model=b.createModel(i)}},prepareData:function d(i){return i},render:function c(i){return a.Super.prototype.render.call(this,this.prepareData(i||{}))}})})(oo);(function(f){var j=this;var n=f.getNS("oo.view").Viewport=f.Class(f.view.Dom,{STATIC:{ANIM_RTL:"rtl",ANIM_LTR:"ltr",NO_ANIM:"none",ANIM_DURATION:750},constructor:function l(s){s=s||f.getConfig("viewportSelector");n.Super.call(this,s);this._panelClasses={};this._panels=[];this._panelsDic=[];this._enabledPanels=[];this._focusedStack=[]},hasPanel:function b(s){return -1!=this._panelsDic.indexOf(s)?true:false},addPanel:function h(t,w,v,s){var u=new (this._panelClasses[t])();u.setId(t);this._panels.push(u);this._panelsDic.push(t);if(w){s=v||s;if(!this.panelIsEnable(t)){this._enablePanel(t)}this.showPanel(t,s)}else{if(v){if(!this.panelIsEnable(t)){this._enablePanel(t)}}}},_identifierToIndex:function e(t){var s;if(typeof t=="string"){s=this._panelsDic.indexOf(t)}return s},_indexToIdentifier:function m(s){return this._panelsDic[s]},_enablePanel:function a(u){var t=this._identifierToIndex(u),s=this._panels[t];s.renderTo(this);if("onEnabled" in s){s.onEnabled()}s.initElement();this._enabledPanels.push(t)},getFocusedPanel:function g(s){index=this._focusedStack[this._focusedStack.length-1];if(s){return undefined!==index?index:false}else{return this.getPanel(this._indexToIdentifier(index))}},getPanel:function r(s){return this._panels[this._identifierToIndex(s)]||false},panelIsEnable:function o(s){return(-1!=this._enabledPanels.indexOf(this._identifierToIndex(s))?true:false)},removePanel:function i(s){var t=this._identifierToIndex(s);this._panels[t].destroy();this._panels.slice(t,1);this._panelsDic.slice(t,1)},showPanel:function q(u,t){this.getPanel(u).show(t||n.ANIM_RTL);var s=this._identifierToIndex(u);this._focusedStack.push(s)},hidePanel:function d(v,u,t){u=u||n.ANIM_RTL;this.getPanel(v).hide(u||n.ANIM_RTL);var s=this._identifierToIndex(v);if(s==this.getFocusedPanel(true)){this._focusedStack.pop()}},switchPanel:function k(x,s,w){var u,t,v;if(arguments.length<=2){u=s||n.ANIM_RTL;v=x;t=this._indexToIdentifier(this.getFocusedPanel(true))}else{t=x;v=s;u=w}if(!this.hasPanel(v)){this.addPanel(v,false,true)}this.showPanel(v,u);if(t){this.hidePanel(t,u)}},register:function c(t,s){this._panelClasses[t]=s},show:function p(s,t){if(!this.hasPanel(s)){this.addPanel(s,true)}if(typeof t=="function"){t.call(j,this.getPanel(this._identifierToIndex(s)))}}})})(oo||{});(function(h){var l=h.getNS("oo.view").Panel=h.Class(h.view.Element,{_uiElements:{},constructor:function e(){l.Super.call(this,{el:document.createElement("div")});if("init" in this){this.init()}},getEl:function d(n){return this._uiElements[n]},addEl:function g(n){this._uiElements[n.getId()]=n},register:function m(n){h.warn("the method oo.view.Panel.register() is deprecated, please use addEl instead");this.addEl(n)},render:function b(){this.classList.addClass("oo-panel");this.appendHtml(l.Super.prototype.render.call(this));return this},initElement:function c(){for(var o in this._uiElements){var n=this._uiElements[o];if("needToRender" in n&&n.needToRender()){n.renderTo(this)}}return this},destroy:function k(){},show:function j(n){this.animShow();this.triggerEvent("onShow")},animShow:function a(r){var o=h.view.Viewport,p=h.getViewport();r=r||o.ANIM_RTL;var n=0;if(r!==o.NO_ANIM){var q=p.getWidth()*(r==o.ANIM_RTL?1:-1);this.setTranslateX(q);n=o.ANIM_DURATION}this.setDisplay("block","");var s=this;this.translateTo({x:0},n)},hide:function f(n){this.animHide(n);this.triggerEvent("onHide")},animHide:function i(s){var o=h.view.Viewport,p=h.getViewport();s=s||o.ANIM_RTL;var n=0;if(s!==o.NO_ANIM){n=o.ANIM_DURATION}var r=p.getWidth()*(s==o.ANIM_RTL?-1:1);var q=this;this.translateTo({x:r},o.ANIM_DURATION,function(){q.setDisplay("none")})}})})(oo||{});(function(e){var d=e.view.Dom,b=e.core.Touch,f=e.getNS("oo.view");var i=f.List=e.Class(e.view.ModelElement,{STATIC:{EVT_RENDER:"render",EVT_ITEM_PRESSED:"item-pressed",EVT_ITEM_RELEASED:"item-released"},_structTpl:'<ul>{{#data}}<li data-id="{{key}}" class="oo-list-item">{{tpl}}</li>{{/data}}</ul>',_touchedItem:null,constructor:function c(j){if(j.structure){this._overrideStructure(j.structure)}i.Super.call(this,j);this._initEvents()},setTemplate:function a(j){this._tpl=this._structTpl.replace("{{tpl}}",j||"")},_initEvents:function(){function k(o){var m=new d(o);var p;if(m.classList.hasClass("oo-list-item")){p=m.getDomObject().getAttribute("data-id")||m.getId()}else{var n=m.findParentByCls("oo-list-item");if(n){m=n;p=n._dom.getAttribute("data-id")||m.getId()}}if(p){return{id:p,dom:m}}return false}var l=this;var j;this.getDomObject().addEventListener(b.EVENT_START,function(m){this._touchedItem=m.target;j=k(m.target);if(false!==j){j.dom.classList.addClass("active");l.triggerEvent(i.EVT_ITEM_PRESSED,[j.dom,j.id])}},false);this.getDomObject().addEventListener(b.EVENT_MOVE,function(n){if(this._touchedItem){this._touchedItem=null;var m=l.find(".active");if(null!==m){m.classList.removeClass("active")}}},false);this.getDomObject().addEventListener(b.EVENT_END,function(m){j=k(m.target);if(false!==j&&this._touchedItem==m.target){j.dom.classList.removeClass("active");l.triggerEvent(i.EVT_ITEM_RELEASED,[j.dom,j.id])}},false)},prepareData:function g(j){return{data:j}},_overrideStructure:function h(j){if(!j){throw Error("Template must be declared")}this._structTpl=j}});e.view.Element.register(i,"list")})(oo||{});(function(h){var d=h.core.Touch;var f=h.getNS("oo.view").Button=h.Class(h.view.Dom,h.core.mixins.Events,{STATIC:{EVT_TOUCH:"touch",EVT_RELEASE:"release"},constructor:function e(l){if(!l||typeof l!="object"){throw'call Element constructor but "options" missing'}if(!l.hasOwnProperty("el")){throw'call Element constructor but "el" property of object options is missing'}f.Super.call(this,l.el);if(l.hasOwnProperty("onrelease")&&typeof l.onrelease==="function"){this.onRelease=l.onrelease}this._active=false;this._initEvents()},_initEvents:function a(){this.getDomObject().addEventListener(d.EVENT_START,h.createDelegate(this._onTouch,this),false);this.getDomObject().addEventListener(d.EVENT_MOVE,h.createDelegate(this._onMove,this),false);this.getDomObject().addEventListener(d.EVENT_END,h.createDelegate(this._onRelease,this),false)},_onTouch:function c(l){this.setActive(true);this.triggerEvent(f.EVT_TOUCH,[this,l])},_onMove:function g(l){this.setActive(false)},_onRelease:function i(l){if(this.isActive()){this.setActive(false);this.onRelease();this.triggerEvent(f.EVT_RELEASE,[this,l])}},onRelease:function j(){},isActive:function k(){return this._active},setActive:function b(l){this._active=!!l;this.classList[(this._active?"add":"remove")+"Class"]("active")}});h.view.Element.register(f,"button")})(oo||{});var oo=(function(l){var a=l.view.Dom,o=l.core.Touch,z=l.getNS("oo.view");var t=z.Carousel=my.Class(l.view.ModelElement,{_datas:null,_elementCls:null,_items:[],_available:true,_newPanel:null,_upPrev:false,_upNext:false,_fromLimit:true,_activePanel:null,constructor:function u(B){if(!B){throw new Error("Missing options")}this._startX=0;this._startTranslate=0;var A={target:B.el||(document.createElement("div"))};t.Super.call(this,A);this._transitionDuration=B.duration||200;if(B){if(!B.hasOwnProperty("model")||!B.hasOwnProperty("elementCls")){throw new Error("Options passed but missing model or elementCls")}if("[object Object]"!==Object.prototype.toString.call(B.elementCls)){throw new Error("elementCls must be an object")}this._elementCls=B.elementCls;this._prepareModel(B)}else{this._prepareView()}},_prepareModel:function m(A){var B=this;this.setModel(A.model);this._model.fetch(function(C){B._datas=C;B._addPanel(0);this._activePanel=0;B._addPanel(1);B._prepareView(A)})},_prepareView:function s(C){this._nbPanel=this._datas.length-1||document.querySelectorAll([C.el," > *"].join("")).length;this._panelWidth=(new a(this.getDomObject().firstElementChild)).getWidth();var D=this.getDomObject().children,B=0,A=D.length;for(B;B<A;B++){D[B].style.width=this._panelWidth+"px"}this.setWidth((this._model)?this._panelWidth*3:this._panelWidth*this._nbPanel,"px");this._activePanel=0;this._displayPager=(C&&C.pager?C.pager:false);this._pager=null;this._buildPager();this._moved=false;this.render()},_addPanel:function p(C,B){var A=this._getItem(C);if(this._panelWidth){A.setWidth(this._panelWidth,"px")}this[(B?"prependChild":"appendChild")](A.getDomObject());A.onEnable()},showPanel:function x(C){if("undefined"===typeof C){throw new Error("Missing 'id' of the panel")}if(C!==this._activePanel&&this._datas[C]&&this._available){if(C>this._activePanel+1){this._updateNext(C);this._upPrev=true}if(C<this._activePanel-1){this._updatePrev(C);this._upNext=true}}this._available=false;var B=(C<this._activePanel?+1:-1),A;if(C>=0&&C<=this._nbPanel&&C!==this._activePanel){A=this._startTranslate+B*this._panelWidth}else{if(C===this._activePanel){A=this._startTranslate}else{if(C<0){A=0;C=0}else{A=this._startTranslate;C=this._nbPanel}}}this.translateTo({x:A},this._transitionDuration);this._startTranslate=A;this._newPanel=C},_moveToStartPlace:function j(){},_updateNext:function h(A){this.removeChild(this.getDomObject().lastChild);this._addPanel(A)},_updatePrev:function e(A){this.removeChild(this.getDomObject().firstChild);this._addPanel(A,true)},_getItem:function i(B){var A=this._items;if(!A[B]){A[B]=this._prepareItem(B)}return A[B]},_prepareItem:function c(C){var B,A=this._datas[C].elementCls;if("undefined"===this._elementCls[A]||"function"!==typeof this._elementCls[A]){throw new Error("element Cls must exist and be a function")}B=new this._elementCls[A]();B.appendHtml(B.render(this._datas[C]));return B},_buildPager:function d(){if(this._displayPager){if("boolean"===typeof this._displayPager){this._buildPagerItem()}else{this._buildPagerList()}}this._updatePager()},_buildPagerItem:function r(){this._pager=a.createElement("div");this._pager.classList.addClass("carousel-pager");this._pager.setTemplate('{{#bullet}}<i class="dot"></i>{{/bullet}}');var B=[];for(var A=0;A<this._nbPanel;A++){B.push(A)}this._pager.render({bullet:B})},_buildPagerList:function q(){var A=this;this._pager=this._displayPager;this._pager.addListener(l.view.List.EVT_ITEM_RELEASED,function(B,C){if(parseInt(C,10)===A._activePanel||!A._available){return}A.showPanel(parseInt(C,10))})},_updatePager:function g(){return},hasMoved:function w(){return this._moved},_initListeners:function b(){var B=this.getDomObject();var A=this;var C;B.addEventListener(o.EVENT_START,function(D){if(A._available){A._startX=o.getPositionX(D);A._startTranslate=A.getTranslateX();C=0}},false);B.addEventListener(o.EVENT_MOVE,function(E){if(A._available){var D=o.getPositionX(E)-A._startX;A.translateTo({x:(A._startTranslate+D)},0);A._moved=true}},false);B.addEventListener(o.EVENT_END,function(){if(A._available){A._moved=false;var D=A.getTranslateX(),E=D-A._startTranslate;if(Math.abs(E)>50){if(D-A._startTranslate<0){A.onSwipeRight()}else{A.onSwipeLeft()}}else{A.translateTo({x:(A._startTranslate)},A._transitionDuration)}A._updatePager()}},false);window.addEventListener("orientationchange",function(){A.refresh.call(A)},false);B.addEventListener("webkitTransitionEnd",function(D){A.onEndTransition.apply(A)},false)},onSwipeRight:function n(){this.showPanel(this._activePanel+1)},onSwipeLeft:function k(){this.showPanel(this._activePanel-1)},onEndTransition:function v(){if(this._activePanel==this._newPanel){this._available=true;return}if(this._newPanel>this._activePanel){if(!this._fromLimit){this.removeChild(this.getDomObject().firstChild);this.translateTo({x:this._startTranslate+this._panelWidth});this._startTranslate=this._startTranslate+this._panelWidth}if(this._newPanel<this._nbPanel){this._addPanel(this._newPanel+1)}}if(this._newPanel<this._activePanel){if(!this._fromLimit){this.removeChild(this.getDomObject().lastChild)}if(this._newPanel>0){this.translateTo({x:this._startTranslate-this._panelWidth});this._addPanel(this._newPanel-1,true);this._startTranslate=this._startTranslate-this._panelWidth}}if(this._upPrev){this._updatePrev(this._newPanel-1);this._upPrev=false}if(this._upNext){this._updateNext(this._newPanel+1);this._upNext=false}this._fromLimit=(this._newPanel<1||this._newPanel==this._nbPanel)?true:false;this._activePanel=this._newPanel;this._available=true},render:function y(){if(this._pager){if("boolean"===typeof this._displayPager){(new a(this.getDomObject().parentNode)).appendChild(this._pager)}else{this._pager.appendHtml(this._pager.render(this._datas))}}this._initListeners()},refresh:function f(){var A=this._panelWidth,B;this._panelWidth=(new a(this.getDomObject().firstElementChild)).getWidth();B=A-this._panelWidth;this.translateTo({x:this._startTranslate+B},0);this._startTranslate=this._startTranslate+B}});l.view.Element.register(t,"carousel");return l})(oo||{});